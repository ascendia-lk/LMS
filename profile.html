<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Ascendia LMS â€” Profile</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">
</head>
<body>
<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="brand"><span class="brand-dot"></span><span>Ascendia LMS</span></div>
    <div class="user-mini">
      <img id="miniAvatar" src="assets/avatar.png" alt="">
      <div class="meta"><div class="fw-semibold">Venusha W.</div><small>Student</small></div>
    </div>
    <nav class="nav-section">
      <a class="nav-link" data-active="dashboard" href="dashboard.html"><i class="bi bi-house"></i>Dashboard</a>
      <a class="nav-link" data-active="courses" href="courses.html"><i class="bi bi-easel2"></i>Courses</a>
      <a class="nav-link" data-active="profile" href="profile.html"><i class="bi bi-person"></i>Profile</a>
      <a class="nav-link" href="#" onclick="logout()"><i class="bi bi-box-arrow-right"></i>Logout</a>
    </nav>
  </aside>

  <!-- Content -->
  <div class="content">
    <!-- TOPBAR with breadcrumb + actions -->
    <div class="topbar">
      <button class="btn btn-outline-secondary btn-sm toggle" onclick="toggleSidebar()"><i class="bi bi-list"></i></button>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb mb-0">
          <li class="breadcrumb-item"><a href="dashboard.html">Dashboard</a></li>
          <li class="breadcrumb-item active" aria-current="page">Profile</li>
        </ol>
      </nav>
      <div class="d-flex align-items-center gap-2 ms-auto">
        <div class="dropdown">
          <button id="notifBell" class="btn btn-outline-secondary btn-sm position-relative notif-bell" data-bs-toggle="dropdown">
            <i class="bi bi-bell"></i><span id="notifDot" class="notif-dot d-none"></span>
          </button>
          <div class="dropdown-menu dropdown-menu-end p-0" id="notifMenu"></div>
        </div>
        <button id="themeToggle" class="btn btn-outline-secondary btn-sm" onclick="toggleTheme()"><i class="bi bi-moon"></i></button>
      </div>
    </div>

    <!-- Page -->
    <main class="page container-fluid">
      <div class="row g-3">
        <!-- Left column -->
        <div class="col-lg-4">
          <div class="card profile-card h-100">
            <div class="card-body">
              <div class="text-center">
                <div class="avatar-wrap mx-auto mb-3">
                  <img id="avatarPreview" src="assets/avatar.png" class="avatar-img" alt="avatar">
                  <label class="avatar-edit" for="avatarInput" data-bs-toggle="tooltip" title="Upload new photo">
                    <i class="bi bi-camera"></i>
                  </label>
                  <input id="avatarInput" type="file" accept="image/*" class="d-none">
                </div>
                <h5 class="mb-0">Venusha Weerasinghe</h5>
                <span class="text-muted small">Trainee Associate QA Specialist</span>
              </div>

              <hr class="my-3">

              <div class="row g-2">
                <div class="col-4"><div class="mini-stat"><div class="mini-stat-value">12</div><div class="mini-stat-label">Courses</div></div></div>
                <div class="col-4"><div class="mini-stat"><div class="mini-stat-value">5</div><div class="mini-stat-label">Badges</div></div></div>
                <div class="col-4"><div class="mini-stat"><div class="mini-stat-value">42h</div><div class="mini-stat-label">Learning</div></div></div>
              </div>

              <div class="mt-3">
                <div class="fw-semibold mb-1">Skills</div>
                <div class="chips">
                  <span class="chip">QA & Testing</span>
                  <span class="chip">JavaScript</span>
                  <span class="chip">SQL</span>
                  <span class="chip">Go</span>
                </div>
              </div>

              <div class="mt-3">
                <div class="fw-semibold mb-1">About</div>
                <p class="text-muted small mb-0">Passionate about building and testing web apps. Learning daily and shipping clean UI.</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Right column -->
        <div class="col-lg-8">
          <div class="card h-100">
            <div class="card-body">
              <ul class="nav nav-pills mb-3" id="profileTabs" role="tablist">
                <li class="nav-item" role="presentation"><button class="nav-link active" id="account-tab" data-bs-toggle="pill" data-bs-target="#account" type="button" role="tab">Account</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link" id="security-tab" data-bs-toggle="pill" data-bs-target="#security" type="button" role="tab">Security</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link" id="prefs-tab" data-bs-toggle="pill" data-bs-target="#preferences" type="button" role="tab">Preferences</button></li>
              </ul>

              <div class="tab-content">
                <!-- Account -->
                <div class="tab-pane fade show active" id="account" role="tabpanel">
                  <form id="accountForm" class="needs-validation" novalidate>
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label small">Full Name</label>
                        <input id="nameInput" class="form-control" value="Venusha Weerasinghe" required>
                        <div class="invalid-feedback">Name is required.</div>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label small">Designation</label>
                        <input id="roleInput" class="form-control" value="Trainee Associate QA Specialist">
                      </div>
                      <div class="col-md-6">
                        <label class="form-label small">Email</label>
                        <input id="emailInput" type="email" class="form-control" value="venusha@example.com" required>
                        <div class="invalid-feedback">Valid email is required.</div>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label small">Phone</label>
                        <input id="phoneInput" class="form-control" value="+94 76 377 3066">
                      </div>
                      <div class="col-12">
                        <label class="form-label small">Bio</label>
                        <textarea id="bioInput" class="form-control" rows="3">Passionate about building and testing web apps.</textarea>
                      </div>
                    </div>
                    <div class="d-flex justify-content-end gap-2 mt-3">
                      <button type="button" class="btn btn-outline-secondary" onclick="resetAccount()">Reset</button>
                      <button type="submit" class="btn btn-dark">Save Changes</button>
                    </div>
                  </form>
                </div>

                <!-- Security -->
                <div class="tab-pane fade" id="security" role="tabpanel">
                  <form id="securityForm" class="needs-validation" novalidate>
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label small">Current Password</label>
                        <div class="input-group">
                          <input id="curPwd" type="password" class="form-control" minlength="4" required>
                          <button class="btn btn-outline-secondary" type="button" onclick="togglePwd('curPwd')"><i class="bi bi-eye"></i></button>
                          <div class="invalid-feedback">Enter current password.</div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label small">New Password</label>
                        <div class="input-group">
                          <input id="newPwd" type="password" class="form-control" minlength="6" required>
                          <button class="btn btn-outline-secondary" type="button" onclick="togglePwd('newPwd')"><i class="bi bi-eye"></i></button>
                          <div class="invalid-feedback">Min 6 characters.</div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label small">Two-Factor Auth</label>
                        <div class="form-check form-switch">
                          <input id="twoFA" class="form-check-input" type="checkbox">
                          <label class="form-check-label" for="twoFA">Enable 2FA (mock)</label>
                        </div>
                      </div>
                    </div>
                    <div class="d-flex justify-content-end gap-2 mt-3">
                      <button type="submit" class="btn btn-dark">Update Security</button>
                    </div>
                  </form>
                </div>

                <!-- Preferences -->
                <div class="tab-pane fade" id="preferences" role="tabpanel">
                  <form id="prefsForm">
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label small">Theme</label>
                        <select id="themeSelect" class="form-select">
                          <option value="light" selected>Light</option>
                          <option value="dark">Dark</option>
                          <option value="system">System</option>
                        </select>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label small">Language</label>
                        <select id="langSelect" class="form-select">
                          <option>English</option>
                          <option>Sinhala</option>
                          <option>Tamil</option>
                        </select>
                      </div>
                      <div class="col-12">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="emailsToggle" checked>
                          <label class="form-check-label" for="emailsToggle">Email me course updates</label>
                        </div>
                      </div>
                    </div>
                    <div class="d-flex justify-content-end gap-2 mt-3">
                      <button type="submit" class="btn btn-dark">Save Preferences</button>
                    </div>
                  </form>
                </div>
              </div>

            </div>
          </div>
        </div>

      </div>
    </main>
  </div>
</div>

<!-- Save Toast -->
<div class="toast position-fixed bottom-0 end-0 m-3" role="alert" aria-live="assertive" aria-atomic="true" id="saveToast">
  <div class="toast-header"><strong class="me-auto">Profile</strong><small>now</small>
    <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
  </div>
  <div class="toast-body" id="saveMsg">Saved!</div>
</div>

<div class="scrim" id="scrim" onclick="toggleSidebar()"></div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/app.js"></script>
<script>
  guard(); setActive('profile');
  document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(el => new bootstrap.Tooltip(el));
  const input = document.getElementById('avatarInput');
  const img = document.getElementById('avatarPreview');
  const mini = document.getElementById('miniAvatar');
  input.addEventListener('change', e=>{
    const file = e.target.files?.[0]; if(!file) return;
    const url = URL.createObjectURL(file); img.src = url; mini.src = url;
  });
  hookFormSaves();
</script>
</body>
</html>
